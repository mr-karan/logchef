import{c as b,d as L,ae as z,R as y,ai as B,a as v,i as s,w as a,u as t,m as d,j as l,_ as w,ap as I,F as M,B as V,k,t as f,o as i}from"./index-DhD1Jy6j.js";import{_ as P,a as j,b as F}from"./CardHeader.vue_vue_type_script_setup_true_lang-B98r7nf9.js";import{_ as Y,a as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7I42q6I.js";import{_ as G,a as H,b as J,c as K,d as Q,e as W,f as X,g as Z}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BAw-LdwS.js";import{T as u,g as R}from"./types-ByjhqKv5.js";import{_ as h}from"./index-DuYWo61Z.js";import{_ as ee}from"./Switch.vue_vue_type_script_setup_true_lang-BnTYLmoW.js";import{_ as te,a as se,b as S,c,d as ae,e as m}from"./TableHeader.vue_vue_type_script_setup_true_lang-ag95AMYa.js";import{u as x}from"./users-DXED7m9B.js";import{P as D}from"./plus-J0EuN1f1.js";import{T as re}from"./trash-2-CmwYiK2P.js";import{f as ne}from"./format-HUUZeily.js";import"./monaco-editor-2qzqsP3x.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=b("ShieldIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=b("UserRoundIcon",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]),ie={class:"space-y-6"},ue={class:"flex items-center justify-between"},de={key:0,class:"text-center py-4"},fe={key:1,class:"rounded-lg border p-4 text-center"},ce={key:2,class:"space-y-4"},me={class:"flex items-center space-x-2"},_e={class:"capitalize"},be=L({__name:"UsersList",setup(pe){const E=I(),{toast:o}=z(),g=y([]),U=y(!0),_=y(!1),p=y(null),$=async()=>{try{const r=await x.listUsers();if("error"in r.data){o({title:"Error",description:r.data.error,variant:"destructive",duration:u.ERROR});return}g.value=r.data}catch(r){console.error("Error loading users:",r),o({title:"Error",description:R(r),variant:"destructive",duration:u.ERROR})}finally{U.value=!1}},T=async()=>{if(p.value)try{const r=await x.deleteUser(p.value.id);if("error"in r.data){o({title:"Error",description:r.data.error,variant:"destructive",duration:u.ERROR});return}o({title:"Success",description:r.data.message,duration:u.SUCCESS}),await $()}catch(r){console.error("Error deleting user:",r),o({title:"Error",description:R(r),variant:"destructive",duration:u.ERROR})}finally{_.value=!1,p.value=null}},N=r=>{p.value=r,_.value=!0},A=async r=>{try{const e=await x.updateUser(r.id,{status:r.status==="active"?"inactive":"active"});if("error"in e.data){o({title:"Error",description:e.data.error,variant:"destructive",duration:u.ERROR});return}o({title:"Success",description:"User status updated successfully",duration:u.SUCCESS}),await $()}catch(e){console.error("Error updating user status:",e),o({title:"Error",description:R(e),variant:"destructive",duration:u.ERROR})}};B($);const C=r=>{if(!r)return"Never";try{const e=new Date(r);return ne(e,"PPp")}catch(e){return console.error("Error formatting date:",e),"Invalid date"}};return(r,e)=>(i(),v("div",ie,[s(t(P),null,{default:a(()=>[s(t(j),null,{default:a(()=>[d("div",ue,[d("div",null,[s(t(Y),null,{default:a(()=>e[4]||(e[4]=[l("Manage Users")])),_:1}),s(t(q),null,{default:a(()=>e[5]||(e[5]=[l(" View and manage your users ")])),_:1})]),s(t(w),{onClick:e[0]||(e[0]=n=>t(E).push({name:"NewUser"}))},{default:a(()=>[s(t(D),{class:"mr-2 h-4 w-4"}),e[6]||(e[6]=l(" Add User "))]),_:1})])]),_:1}),s(t(F),null,{default:a(()=>[U.value?(i(),v("div",de," Loading users... ")):g.value.length===0?(i(),v("div",fe,[e[8]||(e[8]=d("p",{class:"text-muted-foreground mb-4"},"No users found",-1)),s(t(w),{onClick:e[1]||(e[1]=n=>t(E).push({name:"NewUser"}))},{default:a(()=>[s(t(D),{class:"mr-2 h-4 w-4"}),e[7]||(e[7]=l(" Add Your First User "))]),_:1})])):(i(),v("div",ce,[s(t(te),null,{default:a(()=>[s(t(se),null,{default:a(()=>[s(t(S),null,{default:a(()=>[s(t(c),{class:"w-[200px]"},{default:a(()=>e[9]||(e[9]=[l("Name")])),_:1}),s(t(c),{class:"w-[200px]"},{default:a(()=>e[10]||(e[10]=[l("Email")])),_:1}),s(t(c),{class:"w-[100px]"},{default:a(()=>e[11]||(e[11]=[l("Role")])),_:1}),s(t(c),{class:"w-[100px]"},{default:a(()=>e[12]||(e[12]=[l("Status")])),_:1}),s(t(c),{class:"w-[150px]"},{default:a(()=>e[13]||(e[13]=[l("Created At")])),_:1}),s(t(c),{class:"w-[150px]"},{default:a(()=>e[14]||(e[14]=[l("Last Login")])),_:1}),s(t(c),{class:"w-[100px] text-right"},{default:a(()=>e[15]||(e[15]=[l("Actions")])),_:1})]),_:1})]),_:1}),s(t(ae),null,{default:a(()=>[(i(!0),v(M,null,V(g.value,n=>(i(),k(t(S),{key:n.id},{default:a(()=>[s(t(m),{class:"font-medium"},{default:a(()=>[l(f(n.full_name),1)]),_:2},1024),s(t(m),null,{default:a(()=>[l(f(n.email),1)]),_:2},1024),s(t(m),null,{default:a(()=>[s(t(h),{variant:n.role==="admin"?"destructive":"outline",class:"capitalize inline-flex items-center gap-1 font-medium"},{default:a(()=>[n.role==="admin"?(i(),k(t(le),{key:0,class:"h-3 w-3"})):(i(),k(t(oe),{key:1,class:"h-3 w-3"})),l(" "+f(n.role),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(m),null,{default:a(()=>[d("div",me,[s(t(ee),{checked:n.status==="active","onUpdate:checked":O=>A(n)},null,8,["checked","onUpdate:checked"]),d("span",_e,f(n.status),1)])]),_:2},1024),s(t(m),null,{default:a(()=>[l(f(C(n.created_at)),1)]),_:2},1024),s(t(m),null,{default:a(()=>[l(f(C(n.last_login_at)),1)]),_:2},1024),s(t(m),{class:"text-right"},{default:a(()=>[s(t(w),{variant:"destructive",size:"icon",onClick:O=>N(n)},{default:a(()=>[s(t(re),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1})]),_:1}),s(t(G),{open:_.value,"onUpdate:open":e[3]||(e[3]=n=>_.value=!1)},{default:a(()=>[s(t(H),null,{default:a(()=>[s(t(J),null,{default:a(()=>[s(t(K),null,{default:a(()=>e[16]||(e[16]=[l("Delete User")])),_:1}),s(t(Q),{class:"space-y-2"},{default:a(()=>{var n;return[d("p",null,'Are you sure you want to delete user "'+f((n=p.value)==null?void 0:n.full_name)+'"?',1),e[17]||(e[17]=d("p",{class:"font-medium text-destructive"}," This action cannot be undone. ",-1))]}),_:1})]),_:1}),s(t(W),null,{default:a(()=>[s(t(X),{onClick:e[2]||(e[2]=n=>_.value=!1)},{default:a(()=>e[18]||(e[18]=[l(" Cancel ")])),_:1}),s(t(Z),{onClick:T,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:a(()=>e[19]||(e[19]=[l(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}});export{be as default};
