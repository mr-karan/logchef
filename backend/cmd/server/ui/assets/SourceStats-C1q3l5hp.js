import{d as B,ae as E,R as F,au as R,ai as z,a as m,i as a,w as s,u as t,j as o,m as l,k as S,l as b,F as w,B as C,t as n,_ as N,o as r}from"./index-DhD1Jy6j.js";import{_ as v,a as x,b as g}from"./CardHeader.vue_vue_type_script_setup_true_lang-B98r7nf9.js";import{_ as $,a as k}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7I42q6I.js";import{_ as T,a as U,b as V,c as f,d as G,e as _}from"./TableHeader.vue_vue_type_script_setup_true_lang-ag95AMYa.js";import{_ as I,a as P,b as j,c as A,d as D}from"./SelectValue.vue_vue_type_script_setup_true_lang-aDyRn7dA.js";import{u as H}from"./sources-BtojJ080.js";import"./monaco-editor-2qzqsP3x.js";import"./base-AlOswPYA.js";import"./types-ByjhqKv5.js";import"./teams-B0mpmRSw.js";const M={class:"space-y-6"},O={class:"flex gap-4 mb-6"},q={class:"space-y-2 flex-1"},J={class:"flex items-end"},K={key:0},Q={key:1},W={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},X={class:"bg-muted p-3 rounded-md"},Y={class:"text-2xl font-bold"},Z={class:"bg-muted p-3 rounded-md"},h={class:"text-2xl font-bold"},tt={class:"bg-muted p-3 rounded-md"},st={class:"text-2xl font-bold"},et={class:"bg-muted p-3 rounded-md"},at={class:"text-2xl font-bold"},lt={class:"bg-muted p-3 rounded-md"},ot={class:"text-2xl font-bold"},dt={key:2,class:"text-center py-6 text-muted-foreground"},vt=B({__name:"SourceStats",setup(nt){const i=H(),{toast:y}=E(),c=F(""),d=R({tableStats:null,columnStats:null});z(async()=>{i.sources.length===0&&await i.loadSources()});const L=async()=>{if(!c.value){y({title:"Error",description:"Please select a source first",variant:"destructive"});return}const p=await i.getSourceStats(parseInt(c.value));p?(d.tableStats=p.table_stats,d.columnStats=p.column_stats):i.sourceStatsError&&y({title:"Error",description:i.sourceStatsError,variant:"destructive"})};return(p,e)=>(r(),m("div",M,[a(t(v),null,{default:s(()=>[a(t(x),null,{default:s(()=>[a(t($),null,{default:s(()=>e[1]||(e[1]=[o("Source Statistics")])),_:1}),a(t(k),null,{default:s(()=>e[2]||(e[2]=[o(" View disk usage and performance metrics for your ClickHouse tables ")])),_:1})]),_:1}),a(t(g),null,{default:s(()=>[l("div",O,[l("div",q,[e[3]||(e[3]=l("label",{for:"source",class:"block text-sm font-medium"},"Select Source",-1)),a(t(I),{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=u=>c.value=u)},{default:s(()=>[a(t(P),{class:"w-full"},{default:s(()=>[a(t(j),{placeholder:"Select a source"})]),_:1}),a(t(A),null,{default:s(()=>[(r(!0),m(w,null,C(t(i).sources,u=>(r(),S(t(D),{key:u.id,value:String(u.id)},{default:s(()=>[o(n(u.connection.database)+"."+n(u.connection.table_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),l("div",J,[a(t(N),{onClick:L,disabled:t(i).sourceStatsLoading},{default:s(()=>[t(i).sourceStatsLoading?(r(),m("span",K,"Loading...")):(r(),m("span",Q,"Get Stats"))]),_:1},8,["disabled"])])]),d.tableStats?(r(),S(t(v),{key:0,class:"mb-6"},{default:s(()=>[a(t(x),null,{default:s(()=>[a(t($),null,{default:s(()=>e[4]||(e[4]=[o("Table Overview")])),_:1}),a(t(k),null,{default:s(()=>[o(n(d.tableStats.database)+"."+n(d.tableStats.table),1)]),_:1})]),_:1}),a(t(g),null,{default:s(()=>[l("div",W,[l("div",X,[e[5]||(e[5]=l("div",{class:"text-sm text-muted-foreground"},"Rows",-1)),l("div",Y,n(d.tableStats.rows.toLocaleString()),1)]),l("div",Z,[e[6]||(e[6]=l("div",{class:"text-sm text-muted-foreground"},"Parts",-1)),l("div",h,n(d.tableStats.part_count),1)]),l("div",tt,[e[7]||(e[7]=l("div",{class:"text-sm text-muted-foreground"},"Compression Ratio",-1)),l("div",st,n(d.tableStats.compr_rate.toFixed(2))+"x",1)]),l("div",et,[e[8]||(e[8]=l("div",{class:"text-sm text-muted-foreground"},"Compressed Size",-1)),l("div",at,n(d.tableStats.compressed),1)]),l("div",lt,[e[9]||(e[9]=l("div",{class:"text-sm text-muted-foreground"},"Uncompressed Size",-1)),l("div",ot,n(d.tableStats.uncompressed),1)])])]),_:1})]),_:1})):b("",!0),d.columnStats&&d.columnStats.length>0?(r(),S(t(v),{key:1},{default:s(()=>[a(t(x),null,{default:s(()=>[a(t($),null,{default:s(()=>e[10]||(e[10]=[o("Column Statistics")])),_:1}),a(t(k),null,{default:s(()=>e[11]||(e[11]=[o(" Storage and performance metrics for each column ")])),_:1})]),_:1}),a(t(g),null,{default:s(()=>[a(t(T),null,{default:s(()=>[a(t(U),null,{default:s(()=>[a(t(V),null,{default:s(()=>[a(t(f),null,{default:s(()=>e[12]||(e[12]=[o("Column")])),_:1}),a(t(f),null,{default:s(()=>e[13]||(e[13]=[o("Compressed")])),_:1}),a(t(f),null,{default:s(()=>e[14]||(e[14]=[o("Uncompressed")])),_:1}),a(t(f),null,{default:s(()=>e[15]||(e[15]=[o("Compression Ratio")])),_:1}),a(t(f),null,{default:s(()=>e[16]||(e[16]=[o("Avg. Row Size")])),_:1})]),_:1})]),_:1}),a(t(G),null,{default:s(()=>[(r(!0),m(w,null,C(d.columnStats,u=>(r(),S(t(V),{key:u.column},{default:s(()=>[a(t(_),{class:"font-medium"},{default:s(()=>[o(n(u.column),1)]),_:2},1024),a(t(_),null,{default:s(()=>[o(n(u.compressed),1)]),_:2},1024),a(t(_),null,{default:s(()=>[o(n(u.uncompressed),1)]),_:2},1024),a(t(_),null,{default:s(()=>[o(n(u.compr_ratio.toFixed(2))+"x",1)]),_:2},1024),a(t(_),null,{default:s(()=>[o(n(u.avg_row_size.toFixed(2))+" bytes",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):b("",!0),!d.tableStats&&!t(i).sourceStatsLoading?(r(),m("div",dt,' Select a source and click "Get Stats" to view statistics ')):b("",!0)]),_:1})]),_:1})]))}});export{vt as default};
