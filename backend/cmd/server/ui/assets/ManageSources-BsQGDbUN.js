import{d as S,R as g,ai as D,a as f,i as s,w as a,u as e,m as o,j as n,_ as v,ap as T,F as N,B as A,k as L,l as B,t as u,o as r}from"./index-DhD1Jy6j.js";import{_ as V,a as j,b as F}from"./CardHeader.vue_vue_type_script_setup_true_lang-B98r7nf9.js";import{_ as M,a as P}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7I42q6I.js";import{_ as R,a as Y,b as z,c as E,d as H,e as U,f as q,g as G}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BAw-LdwS.js";import{_ as I,a as J,b as w,c as d,d as K,e as i}from"./TableHeader.vue_vue_type_script_setup_true_lang-ag95AMYa.js";import{_ as $}from"./index-DuYWo61Z.js";import{u as O}from"./sources-BtojJ080.js";import{P as y}from"./plus-J0EuN1f1.js";import{T as Q}from"./trash-2-CmwYiK2P.js";import"./monaco-editor-2qzqsP3x.js";import"./base-AlOswPYA.js";import"./types-ByjhqKv5.js";import"./teams-B0mpmRSw.js";const W={class:"space-y-6"},X={class:"flex items-center justify-between"},Z={key:0,class:"text-center py-4"},h={key:1,class:"rounded-lg border p-4 text-center"},ee={key:2,class:"space-y-4"},te={key:0,class:"text-sm text-muted-foreground"},se={class:"font-mono text-xs bg-muted px-2 py-1 rounded"},ae={class:"text-sm space-y-1"},le={class:"flex items-center space-x-2"},ne={class:"font-medium"},oe={class:"flex items-center space-x-2"},ue={class:"font-medium"},ke=S({__name:"ManageSources",setup(de){const x=T(),m=O(),_=g(!1),c=g(null),b=p=>{c.value=p,_.value=!0},k=async()=>{if(!c.value)return;await m.deleteSource(c.value.id)&&(_.value=!1,c.value=null)};D(()=>{m.loadSources()});const C=p=>new Date(p).toLocaleDateString();return(p,t)=>(r(),f("div",W,[s(e(V),null,{default:a(()=>[s(e(j),null,{default:a(()=>[o("div",X,[o("div",null,[s(e(M),null,{default:a(()=>t[4]||(t[4]=[n("Manage Sources")])),_:1}),s(e(P),null,{default:a(()=>t[5]||(t[5]=[n(" View and manage your log sources ")])),_:1})]),s(e(v),{onClick:t[0]||(t[0]=l=>e(x).push({name:"NewSource"}))},{default:a(()=>[s(e(y),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=n(" Add Source "))]),_:1})])]),_:1}),s(e(F),null,{default:a(()=>[e(m).isLoading?(r(),f("div",Z," Loading sources... ")):e(m).sources.length===0?(r(),f("div",h,[t[8]||(t[8]=o("p",{class:"text-muted-foreground mb-4"},"No sources configured yet",-1)),s(e(v),{onClick:t[1]||(t[1]=l=>e(x).push({name:"NewSource"}))},{default:a(()=>[s(e(y),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=n(" Add Your First Source "))]),_:1})])):(r(),f("div",ee,[s(e(I),null,{default:a(()=>[s(e(J),null,{default:a(()=>[s(e(w),null,{default:a(()=>[s(e(d),{class:"w-[200px]"},{default:a(()=>t[9]||(t[9]=[n("Table Name")])),_:1}),s(e(d),{class:"w-[150px]"},{default:a(()=>t[10]||(t[10]=[n("Table Auto Created")])),_:1}),s(e(d),{class:"w-[150px]"},{default:a(()=>t[11]||(t[11]=[n("Timestamp Column")])),_:1}),s(e(d),{class:"w-[300px]"},{default:a(()=>t[12]||(t[12]=[n("Connection")])),_:1}),s(e(d),{class:"w-[100px]"},{default:a(()=>t[13]||(t[13]=[n("Status")])),_:1}),s(e(d),{class:"w-[100px]"},{default:a(()=>t[14]||(t[14]=[n("TTL")])),_:1}),s(e(d),{class:"w-[100px]"},{default:a(()=>t[15]||(t[15]=[n("Created At")])),_:1}),s(e(d),{class:"w-[70px] text-right"},{default:a(()=>t[16]||(t[16]=[n("Actions")])),_:1})]),_:1})]),_:1}),s(e(K),null,{default:a(()=>[(r(!0),f(N,null,A(e(m).sources,l=>(r(),L(e(w),{key:l.id},{default:a(()=>[s(e(i),{class:"font-medium"},{default:a(()=>[n(u(l.connection.table_name)+" ",1),l.description?(r(),f("div",te,u(l.description),1)):B("",!0)]),_:2},1024),s(e(i),null,{default:a(()=>[s(e($),{variant:l._meta_is_auto_created?"default":"secondary",class:"whitespace-nowrap"},{default:a(()=>[n(u(l._meta_is_auto_created?"Yes":"No"),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(i),null,{default:a(()=>[o("code",se,u(l._meta_ts_field),1)]),_:2},1024),s(e(i),null,{default:a(()=>[o("div",ae,[o("div",le,[t[17]||(t[17]=o("span",{class:"text-muted-foreground"},"Host",-1)),o("span",ne,u(l.connection.host),1)]),o("div",oe,[t[18]||(t[18]=o("span",{class:"text-muted-foreground"},"Database",-1)),o("span",ue,u(l.connection.database),1)])])]),_:2},1024),s(e(i),null,{default:a(()=>[s(e($),{variant:l.is_connected?"success":"destructive",class:"whitespace-nowrap"},{default:a(()=>[n(u(l.is_connected?"Connected":"Disconnected"),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(i),null,{default:a(()=>[n(u(l.ttl_days===-1?"Disabled":`${l.ttl_days} days`),1)]),_:2},1024),s(e(i),null,{default:a(()=>[n(u(C(l.created_at)),1)]),_:2},1024),s(e(i),{class:"text-right"},{default:a(()=>[s(e(v),{variant:"destructive",size:"icon",onClick:ie=>b(l)},{default:a(()=>[s(e(Q),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1})]),_:1}),s(e(R),{open:_.value,"onUpdate:open":t[3]||(t[3]=l=>_.value=!1)},{default:a(()=>[s(e(Y),null,{default:a(()=>[s(e(z),null,{default:a(()=>[s(e(E),null,{default:a(()=>t[19]||(t[19]=[n("Delete Source")])),_:1}),s(e(H),{class:"space-y-2"},{default:a(()=>{var l;return[o("p",null,'Are you sure you want to delete source "'+u((l=c.value)==null?void 0:l.connection.table_name)+'"?',1),t[20]||(t[20]=o("p",{class:"font-medium text-muted-foreground"}," Note: This will only remove the source configuration from LogChef. The actual data in Clickhouse will not be deleted - you'll need to manage the data cleanup in Clickhouse separately. ",-1))]}),_:1})]),_:1}),s(e(U),null,{default:a(()=>[s(e(q),{onClick:t[2]||(t[2]=l=>_.value=!1)},{default:a(()=>t[21]||(t[21]=[n(" Cancel ")])),_:1}),s(e(G),{onClick:k,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:a(()=>t[22]||(t[22]=[n(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}});export{ke as default};
