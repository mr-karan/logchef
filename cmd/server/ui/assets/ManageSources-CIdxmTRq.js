import{i as j,d as f,S as V,j as k,w as s,n as I,k as U,e,aY as Y,r as m,o as d,p as T,q as S,m as g,K as z,aZ as q,a_ as K,b as a,a$ as Z,b0 as G,b1 as J,b2 as Q,c as _,l as $,b3 as W,a as v,ak as X,Y as A,g as ee,ao as te,b4 as se,b5 as ae,f as c,b6 as le,_ as R,h as oe,aq as ne,I as re,H as de,a2 as ue,t as b}from"./index-BW90fWs2.js";import{s as B,i as E,T as D,g as O}from"./constants-hx6M80vO.js";import{P,_ as N}from"./index-BLbehGkv.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=j("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ie=f({__name:"AlertDialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const i=V(n,l);return(y,x)=>(d(),k(e(Y),I(U(e(i))),{default:s(()=>[m(y.$slots,"default")]),_:3},16))}}),pe=f({__name:"AlertDialogAction",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,o=T(()=>{const{class:r,...i}=l;return i});return(r,i)=>(d(),k(e(q),S(o.value,{class:e(g)(e(z)(),l.class)}),{default:s(()=>[m(r.$slots,"default")]),_:3},16,["class"]))}}),fe=f({__name:"AlertDialogCancel",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,o=T(()=>{const{class:r,...i}=l;return i});return(r,i)=>(d(),k(e(K),S(o.value,{class:e(g)(e(z)({variant:"outline"}),"mt-2 sm:mt-0",l.class)}),{default:s(()=>[m(r.$slots,"default")]),_:3},16,["class"]))}}),_e=f({__name:"AlertDialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const o=n,r=l,i=T(()=>{const{class:x,...C}=o;return C}),y=V(i,r);return(x,C)=>(d(),k(e(J),null,{default:s(()=>[a(e(Z),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),a(e(G),S(e(y),{class:e(g)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o.class)}),{default:s(()=>[m(x.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),me=f({__name:"AlertDialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,o=T(()=>{const{class:r,...i}=l;return i});return(r,i)=>(d(),k(e(Q),S(o.value,{class:e(g)("text-sm text-muted-foreground",l.class)}),{default:s(()=>[m(r.$slots,"default")]),_:3},16,["class"]))}}),ve=f({__name:"AlertDialogFooter",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("div",{class:$(e(g)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",l.class))},[m(o.$slots,"default")],2))}}),ge=f({__name:"AlertDialogHeader",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("div",{class:$(e(g)("flex flex-col gap-y-2 text-center sm:text-left",l.class))},[m(o.$slots,"default")],2))}}),ye=f({__name:"AlertDialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,o=T(()=>{const{class:r,...i}=l;return i});return(r,i)=>(d(),k(e(W),S(o.value,{class:e(g)("text-lg font-semibold",l.class)}),{default:s(()=>[m(r.$slots,"default")]),_:3},16,["class"]))}}),xe={class:"relative w-full overflow-auto"},be=f({__name:"Table",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("div",xe,[v("table",{class:$(e(g)("w-full caption-bottom text-sm",l.class))},[m(o.$slots,"default")],2)]))}}),$e=f({__name:"TableBody",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("tbody",{class:$(e(g)("[&_tr:last-child]:border-0",l.class))},[m(o.$slots,"default")],2))}}),w=f({__name:"TableCell",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("td",{class:$(e(g)("p-4 align-middle [&:has([role=checkbox])]:pr-0",l.class))},[m(o.$slots,"default")],2))}}),M=f({__name:"TableRow",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("tr",{class:$(e(g)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l.class))},[m(o.$slots,"default")],2))}}),h=f({__name:"TableHead",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("th",{class:$(e(g)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l.class))},[m(o.$slots,"default")],2))}}),we=f({__name:"TableHeader",props:{class:{}},setup(n){const l=n;return(o,r)=>(d(),_("thead",{class:$(e(g)("[&_tr]:border-b",l.class))},[m(o.$slots,"default")],2))}}),he={class:"space-y-6"},ke={class:"flex items-center justify-between"},Ce={key:0,class:"text-center py-4"},De={key:1,class:"rounded-lg border p-4 text-center"},Te={key:2,class:"space-y-4"},Se={key:0,class:"text-sm text-muted-foreground"},Ae={class:"text-sm space-y-1"},Re={class:"flex items-center space-x-2"},Be={class:"font-medium"},Ee={class:"flex items-center space-x-2"},Oe={class:"font-medium"},ze=f({__name:"ManageSources",setup(n){const l=oe(),{toast:o}=X(),r=A([]),i=A(!0),y=A(!1),x=A(null),C=async()=>{try{const p=await B.listSources();if(E(p)){o({title:"Error",description:p.data.error,variant:"destructive",duration:D.ERROR});return}"sources"in p.data&&(r.value=p.data.sources)}catch(p){console.error("Error loading sources:",p),o({title:"Error",description:O(p),variant:"destructive",duration:D.ERROR})}finally{i.value=!1}},L=async()=>{if(x.value)try{const p=await B.deleteSource(x.value.id);if(E(p)){o({title:"Error",description:p.data.error,variant:"destructive",duration:D.ERROR});return}o({title:"Success",description:"Source deleted successfully",duration:D.SUCCESS}),await C()}catch(p){console.error("Error deleting source:",p),o({title:"Error",description:O(p),variant:"destructive",duration:D.ERROR})}finally{y.value=!1,x.value=null}},F=p=>{x.value=p,y.value=!0};ee(C);const H=p=>new Date(p).toLocaleDateString();return(p,t)=>(d(),_("div",he,[a(e(te),null,{default:s(()=>[a(e(se),null,{default:s(()=>[v("div",ke,[v("div",null,[a(e(ae),null,{default:s(()=>t[4]||(t[4]=[c("Manage Sources")])),_:1}),a(e(le),null,{default:s(()=>t[5]||(t[5]=[c(" View and manage your log sources ")])),_:1})]),a(e(R),{onClick:t[0]||(t[0]=u=>e(l).push({name:"NewSource"}))},{default:s(()=>[a(e(P),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=c(" Add Source "))]),_:1})])]),_:1}),a(e(ne),null,{default:s(()=>[i.value?(d(),_("div",Ce," Loading sources... ")):r.value.length===0?(d(),_("div",De,[t[8]||(t[8]=v("p",{class:"text-muted-foreground mb-4"},"No sources configured yet",-1)),a(e(R),{onClick:t[1]||(t[1]=u=>e(l).push({name:"NewSource"}))},{default:s(()=>[a(e(P),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=c(" Add Your First Source "))]),_:1})])):(d(),_("div",Te,[a(e(be),null,{default:s(()=>[a(e(we),null,{default:s(()=>[a(e(M),null,{default:s(()=>[a(e(h),{class:"w-[200px]"},{default:s(()=>t[9]||(t[9]=[c("Table Name")])),_:1}),a(e(h),{class:"w-[100px]"},{default:s(()=>t[10]||(t[10]=[c("Type")])),_:1}),a(e(h),{class:"w-[300px]"},{default:s(()=>t[11]||(t[11]=[c("Connection")])),_:1}),a(e(h),{class:"w-[100px]"},{default:s(()=>t[12]||(t[12]=[c("Status")])),_:1}),a(e(h),{class:"w-[100px]"},{default:s(()=>t[13]||(t[13]=[c("TTL")])),_:1}),a(e(h),{class:"w-[100px]"},{default:s(()=>t[14]||(t[14]=[c("Created At")])),_:1}),a(e(h),{class:"w-[70px] text-right"},{default:s(()=>t[15]||(t[15]=[c("Actions")])),_:1})]),_:1})]),_:1}),a(e($e),null,{default:s(()=>[(d(!0),_(re,null,de(r.value,u=>(d(),k(e(M),{key:u.id},{default:s(()=>[a(e(w),{class:"font-medium"},{default:s(()=>[c(b(u.connection.table_name)+" ",1),u.description?(d(),_("div",Se,b(u.description),1)):ue("",!0)]),_:2},1024),a(e(w),null,{default:s(()=>[a(e(N),{variant:"secondary",class:"capitalize"},{default:s(()=>[c(b(u.schema_type),1)]),_:2},1024)]),_:2},1024),a(e(w),null,{default:s(()=>[v("div",Ae,[v("div",Re,[t[16]||(t[16]=v("span",{class:"text-muted-foreground"},"Host",-1)),v("span",Be,b(u.connection.host),1)]),v("div",Ee,[t[17]||(t[17]=v("span",{class:"text-muted-foreground"},"Database",-1)),v("span",Oe,b(u.connection.database),1)])])]),_:2},1024),a(e(w),null,{default:s(()=>[a(e(N),{variant:u.is_connected?"success":"destructive",class:"whitespace-nowrap"},{default:s(()=>[c(b(u.is_connected?"Connected":"Disconnected"),1)]),_:2},1032,["variant"])]),_:2},1024),a(e(w),null,{default:s(()=>[c(b(u.ttl_days===-1?"Disabled":`${u.ttl_days} days`),1)]),_:2},1024),a(e(w),null,{default:s(()=>[c(b(H(u.created_at)),1)]),_:2},1024),a(e(w),{class:"text-right"},{default:s(()=>[a(e(R),{variant:"destructive",size:"icon",onClick:Pe=>F(u)},{default:s(()=>[a(e(ce),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1})]),_:1}),a(e(ie),{open:y.value,"onUpdate:open":t[3]||(t[3]=u=>y.value=!1)},{default:s(()=>[a(e(_e),null,{default:s(()=>[a(e(ge),null,{default:s(()=>[a(e(ye),null,{default:s(()=>t[18]||(t[18]=[c("Delete Source")])),_:1}),a(e(me),{class:"space-y-2"},{default:s(()=>{var u;return[v("p",null,'Are you sure you want to delete source "'+b((u=x.value)==null?void 0:u.connection.table_name)+'"?',1),t[19]||(t[19]=v("p",{class:"font-medium text-muted-foreground"}," Note: This will only remove the source configuration from LogChef. The actual data in Clickhouse will not be deleted - you'll need to manage the data cleanup in Clickhouse separately. ",-1))]}),_:1})]),_:1}),a(e(ve),null,{default:s(()=>[a(e(fe),{onClick:t[2]||(t[2]=u=>y.value=!1)},{default:s(()=>t[20]||(t[20]=[c(" Cancel ")])),_:1}),a(e(pe),{onClick:L,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:s(()=>t[21]||(t[21]=[c(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}});export{ze as default};
