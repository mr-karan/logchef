import{_ as $,b as x,c as m,d as k,f as v,g as N,e as S,a as b}from"./index-DRDBXXrr.js";import{o,i,d as a,w as e,u as t,N as u,P as C,O as L,a as h,T as d,f as c,j as T,a0 as D,l as p,$ as V,W as B}from"./index-Cty0NdA0.js";const E={class:"rounded-md border"},F={class:"flex flex-col"},I={class:"text-xs text-muted-foreground"},j={class:"truncate"},z={__name:"LogTable",props:{data:{type:Array,required:!0}},setup(g){const f=s=>{switch(s.toLowerCase()){case"error":return"bg-red-500";case"warn":return"bg-yellow-500";case"info":return"bg-blue-500";case"debug":return"bg-gray-500";default:return"bg-gray-500"}},_=s=>new Date(s).toLocaleString();return(s,l)=>(o(),i("div",E,[a(t(S),null,{default:e(()=>[a(t($),null,{default:e(()=>[a(t(x),null,{default:e(()=>[a(t(m),null,{default:e(()=>l[0]||(l[0]=[u("Timestamp")])),_:1}),a(t(m),null,{default:e(()=>l[1]||(l[1]=[u("Service")])),_:1}),a(t(m),null,{default:e(()=>l[2]||(l[2]=[u("Severity")])),_:1}),a(t(m),null,{default:e(()=>l[3]||(l[3]=[u("Message")])),_:1}),a(t(m),null,{default:e(()=>l[4]||(l[4]=[u("Trace ID")])),_:1})]),_:1})]),_:1}),a(t(k),null,{default:e(()=>[(o(!0),i(C,null,L(g.data,n=>(o(),h(t(x),{key:n.id},{default:e(()=>[a(t(v),{class:"font-mono text-sm"},{default:e(()=>[u(d(_(n.timestamp)),1)]),_:2},1024),a(t(v),null,{default:e(()=>[c("div",F,[c("span",null,d(n.service_name),1),c("span",I,d(n.namespace),1)])]),_:2},1024),a(t(v),null,{default:e(()=>[a(t(N),{class:T(f(n.severity_text))},{default:e(()=>[u(d(n.severity_text),1)]),_:2},1032,["class"])]),_:2},1024),a(t(v),{class:"max-w-xl"},{default:e(()=>[c("div",j,d(n.body),1)]),_:2},1024),a(t(v),{class:"font-mono text-sm"},{default:e(()=>[u(d(n.trace_id),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))}},M={class:"container py-8"},Q={key:0,class:"mb-4 p-4 bg-red-50 text-red-600 rounded-md"},q={key:1,class:"flex items-center justify-center h-64"},A={key:2,class:"p-4 mb-4 text-red-700 bg-red-100 rounded-md"},O={key:3,class:"text-center py-8 text-gray-500"},G=D({__name:"QueryView",setup(g){const f=p([]),_=p(!0),s=p(null),l=p("");async function n(){if(!l.value){s.value="No source selected";return}try{_.value=!0;const r=await b.fetchLogs(l.value,{limit:50});f.value=r.logs||[],s.value=null}catch(r){s.value=r instanceof Error?r.message:"Failed to fetch logs",f.value=[]}finally{_.value=!1}}async function w(){try{const r=await b.fetchSources();r.data&&r.data.length>0?(l.value=r.data[0].ID,await n()):s.value="No sources available"}catch(r){s.value=r instanceof Error?r.message:"Failed to fetch sources"}}return V(()=>{w()}),(r,y)=>(o(),i("div",M,[y[1]||(y[1]=c("div",{class:"mb-8"},[c("h1",{class:"text-2xl font-bold"},"Query Explorer"),c("p",{class:"text-sm text-muted-foreground mt-1"},"Search and analyze your logs across all sources.")],-1)),s.value?(o(),i("div",Q,d(s.value),1)):B("",!0),_.value?(o(),i("div",q,y[0]||(y[0]=[c("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1)]))):s.value?(o(),i("div",A,d(s.value),1)):f.value.length===0?(o(),i("div",O," No logs found ")):(o(),h(z,{key:4,data:f.value},null,8,["data"]))]))}});export{G as default};
