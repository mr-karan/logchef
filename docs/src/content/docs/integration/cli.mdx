---
title: LogChef CLI
description: Query and explore your logs from the terminal with the high-performance Rust-based LogChef CLI.
---

import { Card, CardGrid, LinkCard } from "@astrojs/starlight/components";

The LogChef CLI is a powerful, high-performance terminal companion for LogChef. Built in Rust, it provides a fast and intuitive way to interact with your logs without leaving your terminal.

<CardGrid stagger>
  <Card title="Blazing Fast" icon="rocket">
    Written in Rust for minimal overhead and maximum performance when handling large log volumes.
  </Card>
  <Card title="Rich Highlighting" icon="starlight">
    Beautiful syntax highlighting for log levels, dates, IPs, and custom keywords powered by tailspin.
  </Card>
  <Card title="Multi-Context" icon="laptop">
    Manage multiple LogChef instances (dev/staging/prod) with kubectl-style context switching.
  </Card>
  <Card title="Secure Auth" icon="lock">
    Native support for OIDC PKCE flow, keeping your credentials secure while being easy to use.
  </Card>
</CardGrid>

## Quick Start

```bash
# 1. Build the CLI
cd logchef/cli && cargo build --release

# 2. Add to PATH (or copy to /usr/local/bin)
export PATH="$PATH:$(pwd)/target/release"

# 3. Authenticate (auto-creates context from hostname)
logchef auth --server https://logs.example.com

# 4. Rename context to something friendly
logchef config rename logs.example.com prod

# 5. Set defaults so you don't need --team/--source every time
logchef config set team "my-team"
logchef config set source "nginx-logs"

# 6. Query logs
logchef query "level:error" --since 1h
```

## Installation

### From Source

```bash
# Clone the repository
git clone https://github.com/mr-karan/logchef.git
cd logchef/cli

# Build the release binary
cargo build --release

# The binary is at cli/target/release/logchef
# Copy to your PATH:
sudo cp target/release/logchef /usr/local/bin/
```

### Using Just

If you have [just](https://github.com/casey/just) installed:

```bash
# Build release binary
just build-cli

# Build debug binary (faster compilation for testing)
just build-cli-debug

# Install to ~/.cargo/bin (must be in PATH)
just install-cli
```

### Verify Installation

```bash
logchef --version
logchef --help
```

## Authentication

The CLI supports two authentication methods: browser-based OIDC and API tokens.

### Server Prerequisite (OIDC)

To use browser-based auth, configure a public OIDC client for the CLI and set it in the server config:

```toml
[oidc]
cli_client_id = "logchef-cli"
```

Your OIDC provider must allow loopback redirects for the CLI:
`http://127.0.0.1:19876/callback` through `http://127.0.0.1:19878/callback`.

### Browser-Based Login (OIDC)

For interactive use, authenticate via your browser:

```bash
logchef auth
```

This opens your browser to complete the OIDC login flow. The token is automatically saved to your config file.

```bash
# Check authentication status
logchef auth --status

# Log out (clear stored token)
logchef auth --logout
```

### API Token Authentication

For scripts and automation, use an API token directly:

```bash
# Set token via environment variable
export LOGCHEF_AUTH_TOKEN="logchef_1_abc123..."
logchef query ""

# Or pass token as argument
logchef --token "logchef_1_abc123..." query ""

# Or save to config file
logchef config set auth.token "logchef_1_abc123..."
```

Generate API tokens from the LogChef web UI under your profile settings.

## Command Reference

### Query Logs

The `query` command allows you to execute LogChefQL queries directly from your terminal.

```bash
logchef query "level:error service:api" --since 1h
```

#### Options

| Option | Shorthand | Description | Default |
| :--- | :--- | :--- | :--- |
| `--team` | `-t` | Team name (or ID) | (from config) |
| `--source` | `-S` | Source name, `database.table_name`, or ID | (from config) |
| `--since` | `-s` | Time range (e.g., "15m", "1h", "24h") | "15m" |
| `--from` | | Absolute start time (ISO 8601) | |
| `--to` | | Absolute end time (ISO 8601) | |
| `--limit` | `-l` | Maximum number of results | 100 |
| `--output` | | Output format (`text`, `json`, `jsonl`, `table`) | `text` |
| `--no-highlight` | | Disable syntax highlighting | `false` |
| `--no-timestamp` | | Hide timestamp from text output | `false` |
| `--show-sql` | | Display the generated SQL query | `false` |

#### Query Examples

```bash
# Get all logs from the last 15 minutes
logchef query "" --team "production" --source "nginx-logs"

# Use database.table_name format (copy from UI)
logchef query "" --team "production" --source "logs.nomad_apps"

# Filter by field value
logchef query "status:500" --team "production" --source "nginx-logs"

# Multiple conditions (AND)
logchef query "method:POST status:403" --team "production" --source "nginx-logs"

# Search within a time range
logchef query "level:error" --since 1h --limit 50

# Hide timestamp from output
logchef query "level:error" --no-timestamp

# Output as JSON (returns object with logs, stats, columns)
logchef query "status:500" --output json | jq '.logs[] | .host'

# Output as JSON Lines (one JSON object per line, great for jq)
logchef query "" --output jsonl | jq '.msg'

# JSON output is jq-friendly - stats are included in the object
logchef query "" --output json | jq '{count: .count, time_ms: .stats.execution_time_ms}'

# Show the SQL that will be executed
logchef query "method:GET" --show-sql

# Use absolute time range
logchef query "" --from "2026-01-14T00:00:00Z" --to "2026-01-14T12:00:00Z"
```

#### Example Output

When running a query, you'll see highlighted output with colors:

```text
2026-01-14T07:16:06.149Z host=172.100.86.236 method=PATCH status=410 bytes=45112
2026-01-14T07:16:06.049Z host=156.89.90.123 method=PATCH status=200 bytes=42092
2026-01-14T07:16:05.949Z host=217.33.68.177 method=POST status=403 bytes=10709
```

The highlighting includes:
- **Timestamps** in magenta
- **IP addresses** in cyan
- **URLs** with protocol highlighting
- **Key=value pairs** with dimmed keys
- **Numbers** in cyan
- **Log levels** color-coded (ERROR=red, WARN=yellow, INFO=green, DEBUG=blue)

### Configuration

Manage your CLI settings using the `config` command.

```bash
# List all contexts
logchef config list

# Switch to a different context
logchef config use prod

# Show current context configuration
logchef config show

# Set configuration values for current context
logchef config set team 2
logchef config set source 2
logchef config set limit 50
logchef config set since "1h"

# Rename a context
logchef config rename logs.example.com prod

# Delete a context
logchef config delete old-server
```

#### Multi-Context Workflow

The CLI supports managing multiple LogChef instances (dev/staging/prod):

```bash
# Authenticate with prod (context auto-created from hostname)
logchef auth --server https://logs.company.com
logchef config rename logs.company.com prod

# Authenticate with dev
logchef auth --server http://localhost:8125
logchef config rename localhost dev

# List contexts
logchef config list
#     CONTEXT  SERVER                        AUTH
#   * prod     https://logs.company.com      yes
#     dev      http://localhost:8125         yes

# Switch contexts
logchef config use dev
logchef query "level:debug"

# One-off query to different context
logchef --context prod query "level:error"
```

#### Recommended Setup

After authenticating, set your defaults to avoid typing `--team` and `--source` every time:

```bash
# Set defaults using team and source names
logchef config set team "my-team"
logchef config set source "nginx-logs"

# Now you can just run:
logchef query "level:error"
```

:::tip[Source Resolution]
The `--source` flag accepts multiple formats:
- **Friendly name**: `"Kite Nomad"` (case-insensitive)
- **Table reference**: `logs.nomad_apps` (as shown in UI, case-insensitive)  
- **Numeric ID**: `11`

Lookups are cached locally (`~/.cache/logchef/`) for 10 minutes.
:::

## Configuration File

The configuration is stored at `~/.config/logchef/logchef.json`:

```json
{
  "current_context": "prod",
  "contexts": {
    "prod": {
      "server_url": "https://logs.example.com",
      "timeout_secs": 30,
      "token": "logchef_1_...",
      "token_expires_at": "2026-02-14T00:00:00Z",
      "defaults": {
        "team": "production",
        "source": "nginx-logs",
        "limit": 100,
        "since": "15m"
      }
    },
    "dev": {
      "server_url": "http://localhost:8125",
      "timeout_secs": 30,
      "token": "logchef_1_...",
      "defaults": {}
    }
  },
  "highlights": {
    "custom_keywords": ["MYAPP", "CRITICAL"],
    "disable_builtin": false,
    "disabled_groups": [],
    "custom_regexes": [
      {
        "pattern": "trace_id=[a-f0-9]+",
        "color": "cyan",
        "bold": false,
        "italic": false
      }
    ]
  }
}
```

### Configuration Options

| Section | Key | Description |
| :--- | :--- | :--- |
| `current_context` | Active context | Name of the context to use by default |
| `contexts.<name>.server_url` | Server URL | LogChef server address for this context |
| `contexts.<name>.timeout_secs` | Timeout | HTTP request timeout in seconds |
| `contexts.<name>.defaults.team` | Default team | Team name (or ID) to use when `--team` is omitted |
| `contexts.<name>.defaults.source` | Default source | Source name (or ID) to use when `--source` is omitted |
| `contexts.<name>.defaults.limit` | Default limit | Number of results when `--limit` is omitted |
| `contexts.<name>.defaults.since` | Default time range | Time range when `--since` is omitted |
| `highlights.custom_keywords` | Custom keywords | Words to highlight in magenta |
| `highlights.disable_builtin` | Disable defaults | Turn off built-in log level highlighting |
| `highlights.disabled_groups` | Disabled groups | List of highlighter groups to disable |
| `highlights.custom_regexes` | Custom patterns | Regex patterns with custom colors |

## Syntax Highlighting

LogChef CLI provides automatic syntax highlighting for common log patterns, powered by [tailspin](https://github.com/bensadeh/tailspin).

### Built-in Highlighting

| Category | What's Highlighted | Colors |
| :--- | :--- | :--- |
| **Log Levels** | ERROR, FATAL, CRITICAL | Red (bold) |
| | WARN, WARNING | Yellow |
| | INFO | Green |
| | DEBUG, TRACE | Blue |
| **HTTP Methods** | GET | Green (bold) |
| | POST | Yellow (bold) |
| | PUT, PATCH | Magenta (bold) |
| | DELETE | Red (bold) |
| **Identifiers** | IPs, UUIDs, URLs | Cyan/Blue |
| **Temporal** | Dates, timestamps | Magenta |
| **Data** | Numbers, key=value pairs | Cyan |
| **Booleans** | true, false, null | Cyan |

### Ad-hoc Highlighting

Highlight specific words on-the-fly without changing your config:

```bash
# Highlight words in specific colors
logchef query "" --highlight red:ERROR,FAIL --highlight green:SUCCESS,OK

# Available colors: red, green, yellow, blue, magenta, cyan, white, black
# Also: bright_red, bright_green, bright_yellow, etc.
```

### Disable Highlighters

Turn off specific highlighting groups for cleaner output:

```bash
# Disable date/time and number highlighting
logchef query "" --disable-highlight dates --disable-highlight numbers

# Available groups: dates, numbers, uuids, ips, urls, paths, 
#                   pointers, keyvalue, quotes, json, keywords
```

### Custom Regex Patterns

Add custom regex patterns in your config file:

```json
{
  "highlights": {
    "custom_regexes": [
      {
        "pattern": "user_id=(\\d+)",
        "color": "cyan",
        "bold": true
      },
      {
        "pattern": "request_id=[a-f0-9-]+",
        "color": "magenta"
      }
    ]
  }
}
```

### Disable All Highlighting

For piping to other tools or file output:

```bash
logchef query "" --no-highlight > logs.txt
logchef query "" --no-highlight | grep "ERROR"
```

## Output Formats

### JSON Format (`--output json`)

Returns a single JSON object containing logs, stats, and metadata:

```json
{
  "logs": [
    { "_timestamp": "2026-01-20T10:30:00Z", "level": "error", "msg": "..." },
    { "_timestamp": "2026-01-20T10:29:59Z", "level": "info", "msg": "..." }
  ],
  "count": 2,
  "stats": {
    "execution_time_ms": 45,
    "rows_read": 2,
    "bytes_read": 1024
  },
  "query_id": "abc123-...",
  "generated_sql": "SELECT * FROM ...",
  "columns": [
    { "name": "_timestamp", "type": "DateTime64(3)" },
    { "name": "level", "type": "String" }
  ]
}
```

### JSON Lines Format (`--output jsonl`)

Each log entry is output as a separate JSON object on its own line:

```jsonl
{"_timestamp":"2026-01-20T10:30:00Z","level":"error","msg":"Connection failed"}
{"_timestamp":"2026-01-20T10:29:59Z","level":"info","msg":"Request completed"}
```

### Smart Output Detection

The CLI automatically detects if output is going to a terminal (TTY) or being piped:

- **Terminal**: Shows stats summary (`3 logs | 45ms | 3 rows read`)
- **Piped**: Suppresses stats for clean output to `grep`, `jq`, etc.

```bash
# Stats shown (terminal)
logchef query ""
# Output: [logs...]
# 3 logs | 45ms | 3 rows read

# Stats suppressed (piped)
logchef query "" | grep "error"
# Output: [matching lines only, no stats]
```

## Global Options

The following options can be used with any command:

| Option | Environment Variable | Description |
| :--- | :--- | :--- |
| `--context` / `-c` | `LOGCHEF_CONTEXT` | Use a specific context |
| `--server` | `LOGCHEF_SERVER_URL` | Override server URL (ephemeral) |
| `--token` | `LOGCHEF_AUTH_TOKEN` | Override API token |
| `--debug` / `-d` | | Enable detailed debug output |

## Environment Variables

For CI/CD pipelines and automation, you can configure the CLI entirely via environment variables:

```bash
# Option 1: Use a saved context
export LOGCHEF_CONTEXT="prod"
logchef query "level:error" --team "production" --source "app-logs"

# Option 2: Ephemeral mode (no saved context needed)
export LOGCHEF_SERVER_URL="https://logs.example.com"
export LOGCHEF_AUTH_TOKEN="logchef_1_abc123..."
logchef query "level:error" --team "production" --source "app-logs"
```

## Scripting Examples

### Export logs to file

```bash
logchef query "status:500" --output jsonl > errors.jsonl
```

### Count errors with jq

```bash
logchef query "level:error" --output json | jq '.count'
```

### Extract specific fields with jq

```bash
# Get all unique hosts from JSON output
logchef query "status:500" --output json | jq -r '.logs[].host' | sort -u

# Get all unique hosts from JSONL output
logchef query "status:500" --output jsonl | jq -r '.host' | sort -u

# Pretty print messages
logchef query "level:error" --output jsonl | jq '.msg'

# Get query stats
logchef query "" --output json | jq '.stats'
```

### Pipe to grep for filtering

```bash
logchef query "" --no-highlight | grep -i "database"
```

### Clean output without timestamps

```bash
logchef query "level:error" --no-timestamp --no-highlight > errors.txt
```

### Loop through multiple sources

```bash
for source in "nginx-logs" "app-logs" "api-logs"; do
  echo "=== Source: $source ==="
  logchef query "level:error" --source "$source" --limit 5
done
```

<LinkCard
  title="API Reference"
  description="Learn more about the HTTP API that powers the CLI."
  href="/integration/http-api/"
/>
